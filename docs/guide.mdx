---
title: å…¥é—¨æ•™ç¨‹
---

## åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰

æˆ‘ä»¬å°†åœ¨è¿™ä¸ªæ•™ç¨‹å¼€å‘ä¸€ä¸ªç®€å•çš„ V2EX è®ºå›å®¢æˆ·ç«¯ï¼Œä½ å°†åœ¨æœ¬èŠ‚æ•™ç¨‹å­¦åˆ° Taro çš„åŸºç¡€çŸ¥è¯†ã€æ¦‚å¿µå’Œéƒ¨åˆ†ä¼˜åŒ–æŠ€å·§ã€‚å­¦ä¹ è¿™äº›çŸ¥è¯†å¹¶ä¸éœ€è¦äº‹å…ˆäº†è§£ Taroã€å°ç¨‹åºå¼€å‘æˆ–å¤šç«¯å¼€å‘ã€‚å½“ä½ æŒæ¡è¿™äº›çŸ¥è¯†ä¹‹åï¼Œä½ åº”è¯¥å¯ä»¥å¿«é€Ÿé«˜æ•ˆåœ°å¼€å‘å¤šç«¯åº”ç”¨ã€‚

:::tip æç¤º
è¿™ç¯‡æ•™ç¨‹é€‚åˆå¯¹å–œæ¬¢è¾¹å­¦è¾¹åšæˆ–å°ç¨‹åºå¼€å‘å®Œå…¨æ²¡æœ‰äº†è§£çš„å¼€å‘è€…ï¼Œå¦‚æœä½ å€¾å‘äºæŒ‰éƒ¨å°±ç­åœ°å­¦ä¹ ï¼Œè¯·æŠŠ [æ–‡æ¡£](./docs/README) çš„å†…å®¹å…¨éƒ¨è¿‡ä¸€éã€‚å½“ä½ çœ‹å®Œ [æ–‡æ¡£](./docs/README) å°±å¯ä»¥å‘ç°ï¼šæœ¬ç¯‡æ•™ç¨‹å°±æ˜¯æ–‡æ¡£çš„äº’åŠ¨å¼ç´¢å¼•ã€‚
:::

è¿™ç¯‡æ•™ç¨‹å°†åˆ†ä¸ºå››ä¸ªç« èŠ‚ï¼š

- [ç¯å¢ƒå‡†å¤‡](./#ç¯å¢ƒå‡†å¤‡)ï¼šå½“æˆ‘ä»¬ä½¿ç”¨ Taro éœ€è¦å®‰è£…ä»€ä¹ˆä¸œè¥¿ï¼›
- [åŸºç¡€æ•™ç¨‹](./#åŸºç¡€æ•™ç¨‹)ï¼šTaro çš„åŸºç¡€æ¦‚å¿µå’Œå¼€å‘æŒ‡å—ï¼›
- [é¡¹ç›®ä¼˜åŒ–](./#é¡¹ç›®ä¼˜åŒ–)ï¼šå½“é¡¹ç›®å˜å¤§å˜æ…¢æ—¶ï¼Œåº”è¯¥å¦‚ä½•ä¿æŒæˆ–æé«˜åº”ç”¨çš„å¯ç»´æŠ¤æ€§å’Œæ€§èƒ½ï¼›
- [å¤šç«¯å¼€å‘](./#å¤šç«¯å¼€å‘)ï¼šå·²ç»ä½¿ç”¨ Taro å¼€å‘äº†ä¸€ç«¯çš„åº”ç”¨ï¼Œå¦‚ä½•å¿«é€Ÿæ‹“å±•åˆ°å¤šç«¯åº”ç”¨ã€‚

ï¼ˆå¦‚æœä½ åœ¨å¤§å±å¹•æµè§ˆæ—¶ï¼‰åœ¨æœ¬ç¯‡æ•™ç¨‹å³è¾¹çš„æ ‡é¢˜ç›®å½•åŒ…å«äº†æ‰€æœ‰ç« èŠ‚çš„å­ç›®å½•ï¼Œä½ å¯ä»¥æŸ¥çœ‹æˆ–å¯¼èˆªåˆ°ä½ æ„Ÿå…´è¶£çš„ç« èŠ‚ã€‚

### å‰ç½®çŸ¥è¯†

import { VueIcon, ReactIcon } from './guides/index'

åœ¨æœ¬ç¯‡æ•™ç¨‹ä¸­æˆ‘ä»¬å‡å®šä½ å·²ç»å¯¹ Web å‰ç«¯å¼€å‘å’Œ JavaScript æœ‰ä¸€å®šçš„äº†è§£ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ <ReactIcon /> å’Œ <VueIcon /> ä¸¤ä¸ªæ¡†æ¶åˆ†åˆ«å®ç°æˆ‘ä»¬çš„åº”ç”¨ï¼Œåœ¨ä»£ç å®ä¾‹ä¸­ç‚¹å‡» <ReactIcon /> æˆ– <VueIcon /> æŒ‰é’®å°±å¯ä»¥åˆ‡æ¢ä¸åŒçš„å®ç°ã€‚å¦‚æœä½ å¯¹ä¸¤ä¸ªæ¡†æ¶éƒ½ä¸å¤ªç†Ÿæ‚‰ï¼Œå¯ä»¥é€šè¿‡ [React æ–‡æ¡£](https://zh-hans.reactjs.org/)æˆ– [Vue æ–‡æ¡£](https://cn.vuejs.org/)å¯¹ç…§ä»£ç å®ç°ã€‚

åœ¨æˆ‘ä»¬çš„ä»£ç å®ç°ä¸­è¿˜ä¼šä½¿ç”¨éƒ¨åˆ† ES6 è¯­æ³•ï¼Œä½ å¯ä»¥é€šè¿‡ [ES6 å…¥é—¨æ•™ç¨‹](https://es6.ruanyifeng.com/) æŸ¥çœ‹æˆ–å­¦ä¹  ES6 è¯­æ³•ã€‚

## ç¯å¢ƒå‡†å¤‡

ç›®å‰ Taro ä»…æä¾›ä¸€ç§å¼€å‘æ–¹å¼ï¼šå®‰è£… Taro å‘½ä»¤è¡Œå·¥å…·ï¼ˆTaro CLIï¼‰è¿›è¡Œå¼€å‘ã€‚

Taro CLI ä¾èµ–äº Node.js ç¯å¢ƒï¼Œæ‰€ä»¥åœ¨ä½ çš„æœºå™¨ä¸Šå¿…é¡»å®‰è£… Node.js ç¯å¢ƒã€‚å®‰è£… Node.js ç¯å¢ƒæœ‰å¾ˆå¤šç§æ–¹æ³•ï¼Œå¦‚æœä½ å®Œå…¨ä¸äº†è§£ Node.js å¯ä»¥è®¿é—® [Node.js å®˜ç½‘](https://nodejs.org/en/) ä¸‹è½½ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºè¿›è¡Œå®‰è£…ã€‚æˆ‘ä»¬æ¨èå®‰è£… LTS ç‰ˆæœ¬çš„ Node.jsï¼ˆç›®å‰ LTS ç‰ˆæœ¬æ˜¯ v12ï¼‰ã€‚

å½“ä½ çš„æœºå™¨å·²ç»å­˜åœ¨äº† Node.js ç¯å¢ƒï¼Œå¯ä»¥é€šè¿‡åœ¨ç»ˆç«¯è¾“å…¥å‘½ä»¤ `npm i -g @tarojs/cli` å®‰è£… Taro CLIã€‚å®‰è£…å®Œæ¯•ä¹‹åï¼Œåœ¨ç»ˆç«¯è¾“å…¥å‘½ä»¤ `taro`ï¼Œå¦‚æœå‡ºç°ç±»ä¼¼å†…å®¹å°±è¯´æ˜å®‰è£…æˆåŠŸäº†ï¼š

```bash
ğŸ‘½ Taro v3.0.0-beta.6

Usage: taro <command> [options]

Options:
  -V, --version       output the version number
  -h, --help          output usage information

Commands:
  init [projectName]  Init a project with default templete
  config <cmd>        Taro config
  create              Create page for project
  build               Build a project with options
  update              Update packages of taro
  convert             Convert weapp to taro
  info                Diagnostics Taro env info
  doctor              Diagnose taro project
  help [cmd]          display help for [cmd]
```

### ç¼–è¾‘å™¨

æˆ‘ä»¬æ¨èä½¿ç”¨ [VSCode](https://code.visualstudio.com/) æˆ– [WebStorm](https://www.jetbrains.com/webstorm/)ï¼ˆæˆ–å…¶å®ƒæ”¯æŒ Web å¼€å‘çš„ Jetbrains IDEï¼‰ã€‚

å½“ä½ ä½¿ç”¨ VSCode æ—¶ï¼Œæ¨èå®‰è£… [ESLint æ’ä»¶](https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint)ï¼Œå¦‚æœä½ ä½¿ç”¨ TypeScriptï¼Œåˆ«å¿˜äº†é…ç½® `eslint.probe` å‚æ•°ã€‚å¦‚æœä½¿ç”¨ Vueï¼Œæ¨èå®‰è£… [Vetur](https://marketplace.visualstudio.com/items?itemName=octref.vetur) æ’ä»¶ã€‚

å¦‚æœä½ æ„¿æ„èŠ±é’±åˆæ‡’å¾—æŠ˜è…¾å¯ä»¥é€‰æ‹© [WebStorm](https://www.jetbrains.com/webstorm/)ï¼ˆæˆ–å…¶å®ƒæ”¯æŒ Web å¼€å‘çš„ Jetbrains IDEï¼‰ï¼ŒåŸºæœ¬ä¸éœ€è¦é…ç½®ã€‚

ä¸ç®¡ä½¿ç”¨ VSCode è¿˜æ˜¯ WebStromï¼Œå®‰è£…äº†ä¸Šè¿°æ’ä»¶ä¹‹åä½¿ç”¨ Taro éƒ½å®ç°è‡ªåŠ¨è¡¥å…¨å’Œä»£ç å®æ—¶æ£€æŸ¥ï¼ˆlintingï¼‰çš„åŠŸèƒ½ã€‚

### ç»ˆç«¯

#### macOS/Linux

åœ¨ *nix ç³»ç»Ÿä¸­ç»ˆç«¯æ¨¡æ‹Ÿå™¨ä½¿ç”¨ä»€ä¹ˆå·¥å…·ï¼ˆTerminal/iTerm2/Konsole/Hyper/etc..ï¼‰å¹¶ä¸é‡è¦ï¼Œä½†è¿è¡Œ Taro CLI çš„ shell æˆ‘ä»¬æ¨èä½¿ç”¨ `bash` æˆ– `zsh`ã€‚

#### Windows

åœ¨ Windows ä¸­æˆ‘ä»¬æ¨èä½¿ç”¨å†…ç½®çš„ `cmd` æˆ– `PowerShell`ã€‚å¦‚æœæœ‰æ¡ä»¶æ¨èå®‰è£… [WSL](https://docs.microsoft.com/zh-cn/windows/wsl/install-win10) å¹¶ä½¿ç”¨ Linux åˆ†å‘ç‰ˆçš„ç»ˆç«¯è¿è¡Œ Taro CLIã€‚ç”±äº Taro çš„å¼€å‘å›¢é˜Ÿå’Œ CI éƒ½åªè¿è¡Œæˆ–æµ‹è¯• *nix ç³»ç»Ÿï¼Œéƒ¨åˆ† Windows æç«¯æƒ…å†µæˆ–è®¸æ²¡èƒ½è€ƒè™‘åˆ°ï¼Œå¯¼è‡´å‡ºç° Bugã€‚

### å¯»æ±‚å¸®åŠ©

import { Wechat } from './guides/index'

å½“ä½ åœ¨å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜æ—¶ï¼Œä½ å¯ä»¥æ‰«ç åŠ å…¥ <Wechat /> æé—®ï¼Œæˆ–è€…å» [Taro ç¤¾åŒº](https://taro-club.jd.com/) æé—®ã€‚å½“ä½ ç¡®ä¿¡æ˜¯ Taro æœ‰ Bug æ—¶ï¼Œè¯·éšæ—¶å‘ [Taro GitHub Issue](https://github.com/NervJS/taro/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc) æå‡ºä½ çš„é—®é¢˜ã€‚


## åŸºç¡€æ•™ç¨‹

å®‰è£…å¥½ Taro CLI ä¹‹åå¯ä»¥é€šè¿‡ `taro init` å‘½ä»¤åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„é¡¹ç›®ï¼Œä½ å¯ä»¥æ ¹æ®ä½ çš„é¡¹ç›®éœ€æ±‚å¡«å†™å„ä¸ªé€‰é¡¹ï¼Œä¸€ä¸ªæœ€å°ç‰ˆæœ¬çš„ Taro é¡¹ç›®ä¼šåŒ…æ‹¬ä»¥ä¸‹æ–‡ä»¶ï¼š

```bash
â”œâ”€â”€ babel.config.js             # Babel é…ç½®
â”œâ”€â”€ .eslintrc.js                # ESLint é…ç½®
â”œâ”€â”€ config                      # ç¼–è¯‘é…ç½®ç›®å½•
â”‚Â Â  â”œâ”€â”€ dev.js                  # å¼€å‘æ¨¡å¼é…ç½®
â”‚Â Â  â”œâ”€â”€ index.js                # é»˜è®¤é…ç½®
â”‚Â Â  â””â”€â”€ prod.js                 # ç”Ÿäº§æ¨¡å¼é…ç½®
â”œâ”€â”€ package.json                # Node.js manifest
â”œâ”€â”€ dist                        # æ‰“åŒ…ç›®å½•
â”œâ”€â”€ project.config.json         # å°ç¨‹åºé¡¹ç›®é…ç½®
â”œâ”€â”€ src # æºç ç›®å½•
â”‚Â Â  â”œâ”€â”€ app.config.js           # å…¨å±€é…ç½®
â”‚Â Â  â”œâ”€â”€ app.css                 # å…¨å±€ CSS
â”‚Â Â  â”œâ”€â”€ app.js                  # å…¥å£ç»„ä»¶
â”‚Â Â  â”œâ”€â”€ index.html              # H5 å…¥å£ HTML
â”‚Â Â  â””â”€â”€ pages                   # é¡µé¢ç»„ä»¶
â”‚Â Â      â””â”€â”€ index
â”‚Â Â          â”œâ”€â”€ index.config.js # é¡µé¢é…ç½®
â”‚Â Â          â”œâ”€â”€ index.css       # é¡µé¢ CSS
â”‚Â Â          â””â”€â”€ index.jsx       # é¡µé¢ç»„ä»¶ï¼Œå¦‚æœæ˜¯ Vue é¡¹ç›®ï¼Œæ­¤æ–‡ä»¶ä¸º index.vue
```

æˆ‘ä»¬ä»¥åå°†ä¼šè®²è§£æ¯ä¸€ä¸ªæ–‡ä»¶çš„ä½œç”¨ï¼Œä½†ç°åœ¨ï¼Œæˆ‘ä»¬å…ˆæŠŠæ³¨æ„åŠ›èšç„¦åœ¨ `src` æ–‡ä»¶å¤¹ï¼Œä¹Ÿå°±æ˜¯æºç ç›®å½•ï¼š

### å…¥å£ç»„ä»¶

æ¯ä¸€ä¸ª Taro é¡¹ç›®éƒ½æœ‰ä¸€ä¸ªå…¥å£ç»„ä»¶å’Œä¸€ä¸ªå…¥å£é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¥å£ç»„ä»¶ä¸­è®¾ç½®å…¨å±€çŠ¶æ€/å…¨å±€ç”Ÿå‘½å‘¨æœŸï¼Œä¸€ä¸ªæœ€å°åŒ–çš„å…¥å£ç»„ä»¶ä¼šæ˜¯è¿™æ ·ï¼š

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<Tabs
  defaultValue="React"
  values={[
    { label: <ReactIcon />, value: 'React', },
    { label: <VueIcon />, value: 'Vue', }
  ]
}>

<TabItem value="React">

```jsx title="src/app.js"
import React, { Component } from 'react'
import './app.css'

class App extends Component {
  render () {
    // this.props.children æ˜¯å°†è¦ä¼šæ¸²æŸ“çš„é¡µé¢
    return this.props.children
  }
}

// æ¯ä¸€ä¸ªå…¥å£ç»„ä»¶éƒ½å¿…é¡»å¯¼å‡ºä¸€ä¸ª React ç»„ä»¶
export default App
```

</TabItem>

<TabItem value="Vue">

```js title="src/app.js"
import Vue from 'vue'
import './app.css'

const App = new Vue({
  render(h) {
    // this.$slots.default æ˜¯å°†è¦ä¼šæ¸²æŸ“çš„é¡µé¢
    return h('block', this.$slots.default)
  }
})

export default App
```

</TabItem>

</Tabs>


æ¯ä¸€ä¸ªå…¥å£ç»„ä»¶ï¼ˆä¾‹å¦‚ `app.js`ï¼‰æ€»æ˜¯ä¼´éšä¸€ä¸ªå…¨å±€é…ç½®æ–‡ä»¶ï¼ˆä¾‹å¦‚ `app.config.js`ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¨å±€é…ç½®æ–‡ä»¶ä¸­è®¾ç½®é¡µé¢ç»„ä»¶çš„è·¯å¾„ã€å…¨å±€çª—å£ã€è·¯ç”±ç­‰ä¿¡æ¯ï¼Œä¸€ä¸ªæœ€ç®€å•çš„å…¨å±€é…ç½®å¦‚ä¸‹ï¼š

<Tabs
  defaultValue="React"
  values={[
    { label: <ReactIcon />, value: 'React', },
    { label: <VueIcon />, value: 'Vue', }
  ]
}>

<TabItem value="React">

```js title="src/app.config.js"
export default {
  pages: [
    'pages/index/index'
  ]
}
```

</TabItem>

<TabItem value="Vue">


```js title="src/app.config.js"
export default {
  pages: [
    'pages/index/index'
  ]
}
```

</TabItem>

</Tabs>

ä½ å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œä¸ç®¡æ˜¯ <ReactIcon /> è¿˜æ˜¯ <VueIcon />ï¼Œä¸¤è€…çš„å…¨å±€é…ç½®æ˜¯ä¸€æ ·çš„ã€‚è¿™æ˜¯åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼ŒTaro å¹¶ä¸å…³å¿ƒæ¡†æ¶çš„åŒºåˆ«ï¼ŒTaro CLI ä¼šç›´æ¥åœ¨ç¼–è¯‘æ—¶åœ¨ Node.js ç¯å¢ƒç›´æ¥æ‰§è¡Œå…¨å±€é…ç½®çš„ä»£ç ï¼Œå¹¶æŠŠ `export default` å¯¼å‡ºçš„å¯¹è±¡åºåˆ—åŒ–ä¸ºä¸€ä¸ª JSON æ–‡ä»¶ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¦è®²åˆ° [é¡µé¢é…ç½®](./#é¡µé¢é…ç½®) ä¹Ÿæ˜¯åŒæ ·çš„æ‰§è¡Œé€»è¾‘ã€‚

å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»ä¿è¯é…ç½®æ–‡ä»¶æ˜¯åœ¨ Node.js ç¯å¢ƒä¸­æ˜¯å¯ä»¥æ‰§è¡Œçš„ï¼Œä¸èƒ½ä½¿ç”¨ä¸€äº›åœ¨ H5 ç¯å¢ƒæˆ–å°ç¨‹åºç¯å¢ƒæ‰èƒ½è¿è¡Œçš„åŒ…æˆ–è€…ä»£ç ï¼Œå¦åˆ™ç¼–è¯‘å°†ä¼šå¤±è´¥ã€‚

:::info äº†è§£æ›´å¤š
Taro çš„å…¥å£ç»„ä»¶å’Œå…¨å±€é…ç½®è§„èŒƒæ˜¯åŸºäºå¾®ä¿¡å°ç¨‹åºè€Œåˆ¶å®šçš„ï¼Œå¹¶å¯¹å…¨å¹³å°è¿›è¡Œç»Ÿä¸€ã€‚
ä½ å¯ä»¥é€šè¿‡è®¿é—® [React å…¥å£ç»„ä»¶](./docs/react#å…¥å£ç»„ä»¶) å’Œ [Vue å…¥å£ç»„ä»¶](./docs/vue#å…¥å£ç»„ä»¶)ï¼Œä»¥åŠ [å…¨å±€é…ç½®](./docs/tutorial#å…¨å±€é…ç½®) äº†è§£å…¥å£ç»„ä»¶å’Œå…¨å±€é…ç½®çš„è¯¦æƒ…ã€‚
:::

### é¡µé¢ç»„ä»¶

é¡µé¢ç»„ä»¶æ˜¯æ¯ä¸€é¡¹è·¯ç”±å°†ä¼šæ¸²æŸ“çš„é¡µé¢ï¼ŒTaro çš„é¡µé¢é»˜è®¤æ”¾åœ¨ `src/pages` ä¸­ï¼Œæ¯ä¸€ä¸ª Taro é¡¹ç›®è‡³å°‘æœ‰ä¸€ä¸ªé¡µé¢ç»„ä»¶ã€‚åœ¨æˆ‘ä»¬ç”Ÿæˆçš„é¡¹ç›®ä¸­æœ‰ä¸€ä¸ªé¡µé¢ç»„ä»¶ï¼š`src/pages/index/index`ï¼Œç»†å¿ƒçš„æœ‹å‹å¯ä»¥å‘ç°ï¼Œè¿™ä¸ªè·¯å¾„æ°å·§å¯¹åº”çš„å°±æ˜¯æˆ‘ä»¬[å…¨å±€é…ç½®](#å…¨å±€é…ç½®)çš„ `pages` å­—æ®µå½“ä¸­çš„å€¼ã€‚ä¸€ä¸ªç®€å•çš„é¡µé¢ç»„ä»¶å¦‚ä¸‹ï¼š

<Tabs
  defaultValue="React"
  values={[
    { label: <ReactIcon />, value: 'React', },
    { label: <VueIcon />, value: 'Vue', }
  ]
}>

<TabItem value="React">

```jsx title="src/pages/index/index.jsx"
import { View } from '@tarojs/components'
class Index extends Component {
  state = {
    msg: 'Hello World!'
  }

  onReady () {
    console.log('onReady')
  }

  render () {
    return <View>{ this.state.msg }</View>
  }
}

export default Index
```

</TabItem>

<TabItem value="Vue">

```html title="src/pages/index/index.vue"
<template>
  <view>
    {{ msg }}
  </view>
</template>

<script>

export default {
  data() {
    return {
      msg: 'Hello World!'
    };
  },
  onReady () {
    console.log('onReady')
  }
};
</script>
```

</TabItem>

</Tabs>


è¿™ä¸æ­£æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„ <ReactIcon /> å’Œ <VueIcon /> ç»„ä»¶å—ï¼ä½†è¿˜æ˜¯æœ‰ä¸¤ç‚¹ç»†å¾®çš„å·®åˆ«ï¼š

1. `onReady` ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚è¿™æ˜¯æ¥æºäºå¾®ä¿¡å°ç¨‹åºè§„èŒƒçš„ç”Ÿå‘½å‘¨æœŸï¼Œè¡¨ç¤ºç»„ä»¶é¦–æ¬¡æ¸²æŸ“å®Œæ¯•ï¼Œå‡†å¤‡å¥½ä¸è§†å›¾äº¤äº’ã€‚Taro åœ¨è¿è¡Œæ—¶å°†å¤§éƒ¨åˆ†å°ç¨‹åºè§„èŒƒé¡µé¢ç”Ÿå‘½å‘¨æœŸæ³¨å…¥åˆ°äº†é¡µé¢ç»„ä»¶ä¸­ï¼ŒåŒæ—¶ React æˆ– Vue è‡ªå¸¦çš„ç”Ÿå‘½å‘¨æœŸä¹Ÿæ˜¯å®Œå…¨å¯ä»¥æ­£å¸¸ä½¿ç”¨çš„ã€‚
2. `View` ç»„ä»¶ã€‚è¿™æ˜¯æ¥æºäº `@tarojs/components` çš„è·¨å¹³å°ç»„ä»¶ã€‚ç›¸å¯¹äºæˆ‘ä»¬ç†Ÿæ‚‰çš„ `div`ã€`span` å…ƒç´ è€Œè¨€ï¼Œåœ¨ Taro ä¸­æˆ‘ä»¬è¦å…¨éƒ¨ä½¿ç”¨è¿™æ ·çš„è·¨å¹³å°ç»„ä»¶è¿›è¡Œå¼€å‘ã€‚

å’Œå…¥å£ç»„ä»¶ä¸€æ ·ï¼Œæ¯ä¸€ä¸ªé¡µé¢ç»„ä»¶ï¼ˆä¾‹å¦‚ `index.vue`ï¼‰ä¹Ÿä¼šæœ‰ä¸€ä¸ªé¡µé¢é…ç½®ï¼ˆä¾‹å¦‚ `index.config.js`ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é¡µé¢é…ç½®æ–‡ä»¶ä¸­è®¾ç½®é¡µé¢çš„å¯¼èˆªæ ã€èƒŒæ™¯é¢œè‰²ç­‰å‚æ•°ï¼Œä¸€ä¸ªæœ€ç®€å•çš„é¡µé¢é…ç½®å¦‚ä¸‹ï¼š

```jsx title="src/pages/index/index.config.js"
export default {
  navigationBarTitleText: 'é¦–é¡µ'
}
```

:::info äº†è§£æ›´å¤š
Taro çš„é¡µé¢é’©å­å‡½æ•°å’Œé¡µé¢é…ç½®è§„èŒƒæ˜¯åŸºäºå¾®ä¿¡å°ç¨‹åºè€Œåˆ¶å®šçš„ï¼Œå¹¶å¯¹å…¨å¹³å°è¿›è¡Œç»Ÿä¸€ã€‚
ä½ å¯ä»¥é€šè¿‡è®¿é—® [React é¡µé¢ç»„ä»¶](./docs/react#é¡µé¢ç»„ä»¶) å’Œ [Vue é¡µé¢ç»„ä»¶](./docs/vue#é¡µé¢ç»„ä»¶) äº†è§£å…¨éƒ¨é¡µé¢é’©å­å‡½æ•°å’Œé¡µé¢é…ç½®è§„èŒƒã€‚
:::

### è‡ªå®šä¹‰ç»„ä»¶

å¦‚æœä½ çœ‹åˆ°è¿™é‡Œï¼Œé‚£ä¸å¾—ä¸æ­å–œä½ ï¼Œä½ å·²ç»ç†è§£äº† Taro ä¸­æœ€å¤æ‚çš„æ¦‚å¿µï¼šå…¥å£ç»„ä»¶å’Œé¡µé¢ç»„ä»¶ï¼Œå¹¶äº†è§£äº†å®ƒä»¬æ˜¯å¦‚ä½•ï¼ˆé€šè¿‡é…ç½®æ–‡ä»¶ï¼‰äº¤äº’çš„ã€‚æ¥ä¸‹æ¥çš„å†…å®¹ï¼Œå¦‚æœä½ å·²ç»ç†Ÿæ‚‰äº† <ReactIcon /> æˆ– <VueIcon /> ä»¥åŠ Web å¼€å‘çš„è¯ï¼Œé‚£å°±å¤ªç®€å•äº†ï¼š

æˆ‘ä»¬å…ˆæŠŠé¦–é¡µå†™å¥½ï¼Œé¦–é¡µçš„é€»è¾‘å¾ˆç®€å•ï¼šæŠŠè®ºå›æœ€æ–°çš„å¸–å­å±•ç¤ºå‡ºæ¥ã€‚

<Tabs
  defaultValue="React"
  values={[
    { label: <ReactIcon />, value: 'React', },
    { label: <VueIcon />, value: 'Vue', }
  ]
}>

<TabItem value="React">

```jsx title="src/pages/index/index.jsx"
import Taro from '@tarojs/taro'
import React from 'react'
import { View } from '@tarojs/components'
import { ThreadList } from '../../components/thread_list'
import api from '../../utils/api'

import './index.css'

class Index extends React.Component {
  config = {
    navigationBarTitleText: 'é¦–é¡µ'
  }

  state = {
    loading: true,
    threads: []
  }

  async componentDidMount () {
    try {
      const res = await Taro.request({
        url: api.getLatestTopic()
      })
      this.setState({
        threads: res.data,
        loading: false
      })
    } catch (error) {
      Taro.showToast({
        title: 'è½½å…¥è¿œç¨‹æ•°æ®é”™è¯¯'
      })
    }
  }

  render () {
    const { loading, threads } = this.state
    return (
      <View className='index'>
        <ThreadList
          threads={threads}
          loading={loading}
        />
      </View>
    )
  }
}

export default Index
```

</TabItem>

<TabItem value="Vue">

```html title="src/pages/index/index.vue"
<template>
  <view class='index'>
    <thread-list
      :threads="threads"
      :loading="loading"
    />
  </view>
</template>

<script>
import Vue from 'vue'
import Taro from '@tarojs/taro'
import api from '../../utils/api'
import ThreadList from '../../components/thread_list.vue'
export default {
  components: {
    'thread-list': ThreadList
  },
  data () {
    return {
      loading: true,
      threads: []
    }
  },
  async created() {
    try {
      const res = await Taro.request({
        url: api.getLatestTopic()
      })
      this.loading = false
      this.threads = res.data
    } catch (error) {
      Taro.showToast({
        title: 'è½½å…¥è¿œç¨‹æ•°æ®é”™è¯¯'
      })
    }
  }
}
</script>
```

</TabItem>

</Tabs>

:::info äº†è§£æ›´å¤š
å¯èƒ½ä½ ä¼šæ³¨æ„åˆ°åœ¨ä¸€ä¸ª Taro åº”ç”¨ä¸­å‘é€è¯·æ±‚æ˜¯ `Taro.request()` å®Œæˆçš„ã€‚
å’Œé¡µé¢é…ç½®ã€å…¨å±€é…ç½®ä¸€æ ·ï¼ŒTaro çš„ API è§„èŒƒä¹Ÿæ˜¯åŸºäºå¾®ä¿¡å°ç¨‹åºè€Œåˆ¶å®šçš„ï¼Œå¹¶å¯¹å…¨å¹³å°è¿›è¡Œç»Ÿä¸€ã€‚
ä½ å¯ä»¥é€šè¿‡åœ¨ [API æ–‡æ¡£](./apis/about/desc) æ‰¾åˆ°æ‰€æœ‰ APIã€‚
:::

åœ¨æˆ‘ä»¬çš„é¦–é¡µç»„ä»¶é‡Œï¼Œè¿˜å¼•ç”¨äº†ä¸€ä¸ª `ThreadList` ç»„ä»¶ï¼Œæˆ‘ä»¬ç°åœ¨æ¥å®ç°å®ƒï¼š

<Tabs
  defaultValue="React"
  values={[
    { label: <ReactIcon />, value: 'React', },
    { label: <VueIcon />, value: 'Vue', }
  ]
}>

<TabItem value="React">

```jsx title="src/components/thread_list.jsx"
import React from 'react'
import { View, Text } from '@tarojs/components'
import { Thread } from './thread'
import { Loading } from './loading'

import './thread.css'

class ThreadList extends React.Component {
  static defaultProps = {
    threads: [],
    loading: true
  }

  render () {
    const { loading, threads } = this.props

    if (loading) {
      return <Loading />
    }

    const element = threads.map((thread, index) => {
      return (
        <Thread
          key={thread.id}
          node={thread.node}
          title={thread.title}
          last_modified={thread.last_modified}
          replies={thread.replies}
          tid={thread.id}
          member={thread.member}
        />
      )
    })

    return (
      <View className='thread-list'>
        {element}
      </View>
    )
  }
}

export { ThreadList }
```

```jsx title="src/components/thread.jsx"
import Taro, { eventCenter } from '@tarojs/taro'
import React from 'react'
import { View, Text, Navigator, Image } from '@tarojs/components'

import api from '../utils/api'
import { timeagoInst, Thread_DETAIL_NAVIGATE } from '../utils'

class Thread extends React.Component {

  handleNavigate = () => {
    const { tid, not_navi } = this.props
    if (not_navi) {
      return
    }
    eventCenter.trigger(Thread_DETAIL_NAVIGATE, this.props)
    // è·³è½¬åˆ°å¸–å­è¯¦æƒ…
    Taro.navigateTo({
      url: '/pages/thread_detail/thread_detail'
    })
  }

  render () {
    const { title, member, last_modified, replies, node, not_navi } = this.props
    const time = timeagoInst.format(last_modified * 1000, 'zh')
    const usernameCls = `author ${not_navi ? 'bold' : ''}`

    return (
      <View className='thread' onClick={this.handleNavigate}>
        <View className='info'>
          <View>
            <Image src={member.avatar_large} className='avatar' />
          </View>
          <View className='middle'>
            <View className={usernameCls}>
                {member.username}
            </View>
            <View className='replies'>
              <Text className='mr10'>
                {time}
              </Text>
              <Text>
                è¯„è®º {replies}
              </Text>
            </View>
          </View>
          <View className='node'>
            <Text className='tag'>
              {node.title}
            </Text>
          </View>
        </View>
        <Text className='title'>
          {title}
        </Text>
      </View>
    )
  }
}

export { Thread }
```
</TabItem>

<TabItem value="Vue">

```html title="src/components/thread_list.vue"
<template>
  <view className='thread-list'>
    <loading v-if="loading" />
    <thread
      v-else
      v-for="t in threads"
      :key="t.id"
      :node="t.node"
      :title="t.title"
      :last_modified="t.last_modified"
      :replies="t.replies"
      :tid="t.id"
      :member="t.member"
    />
  </view>
</template>

<script >
import Vue from 'vue'
import Loading from './loading.vue'
import Thread from './thread.vue'
export default {
  components: {
    'loading': Loading,
    'thread': Thread
  },
  props: {
    threads: {
      type: Array,
      default: []
    },
    loading: {
      type: Boolean,
      default: true
    }
  }
}
</script>
```

```html title="src/components/thread.vue"
<template>
  <view class='thread' @tap="handleNavigate">
    <view class='info'>
      <view>
        <image :src="member.avatar_large | url" class='avatar' />
      </view>
      <view class='middle'>
        <view :class="usernameCls">
            {{member.username}}
        </view>
        <view class='replies'>
          <text class='mr10'>{{time}}</text>
          <text>è¯„è®º {{replies}}</text>
        </view>
      </view>
      <view class='node'>
        <text class='tag'>{{node.title}}</Text>
      </view>
    </view>
    <text class='title'>{{title}}</text>
  </view>
</template>

<script>
import Vue from 'vue'
import { eventCenter } from '@tarojs/taro'
import Taro from '@tarojs/taro'
import { timeagoInst, Thread_DETAIL_NAVIGATE } from '../utils'
import './thread.css'
export default {
  props: ['title', 'member', 'last_modified', 'replies', 'node', 'not_navi', 'tid'],
  computed: {
    time () {
      return timeagoInst.format(this.last_modified * 1000, 'zh')
    },
    usernameCls () {
      return `author ${this.not_navi ? 'bold' : ''}`
    }
  },
  filters: {
    url (val) {
      return 'https:' + val
    }
  },
  methods: {
    handleNavigate () {
      const { tid, not_navi } = this.$props
      if (not_navi) {
        return
      }
      eventCenter.trigger(Thread_DETAIL_NAVIGATE, this.$props)
      // è·³è½¬åˆ°å¸–å­è¯¦æƒ…
      Taro.navigateTo({
        url: '/pages/thread_detail/thread_detail'
      })
    }
  }
}
</script>
```

</TabItem>

</Tabs>

è¿™é‡Œå¯ä»¥å‘ç°æˆ‘ä»¬æŠŠè®ºå›å¸–å­æ¸²æŸ“é€»è¾‘æ‹†æˆäº†ä¸¤ä¸ªç»„ä»¶ï¼Œå¹¶æ”¾åœ¨ `src/components` æ–‡ä»¶ä¸­ï¼Œå› ä¸ºè¿™äº›ç»„ä»¶æ˜¯ä¼šåœ¨å…¶å®ƒé¡µé¢ä¸­å¤šæ¬¡ç”¨åˆ°ã€‚
æ‹†åˆ†ç»„ä»¶çš„åŠ›åº¦æ˜¯å®Œå…¨ç”±å¼€å‘è€…å†³å®šçš„ï¼ŒTaro å¹¶æ²¡æœ‰è§„å®šç»„ä»¶ä¸€å®šè¦æ”¾åœ¨ `components` æ–‡ä»¶å¤¹ï¼Œä¹Ÿæ²¡æœ‰è§„å®šé¡µé¢ä¸€å®šè¦æ”¾åœ¨ `pages` æ–‡ä»¶å¤¹ã€‚

å¦å¤–ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„ç‚¹æ˜¯ï¼šæˆ‘ä»¬å¹¶æ²¡æœ‰ä½¿ç”¨ `div`/`span` è¿™æ ·çš„ HTML ç»„ä»¶ï¼Œè€Œæ˜¯ä½¿ç”¨äº† `View`/`Text` è¿™æ ·çš„è·¨å¹³å°ç»„ä»¶ã€‚

:::info äº†è§£æ›´å¤š
Taro æ–‡æ¡£çš„[è·¨å¹³å°ç»„ä»¶åº“](./docs/components-desc) åŒ…å«äº†æ‰€æœ‰ç»„ä»¶å‚æ•°å’Œç”¨æ³•ã€‚ä½†ç›®å‰ç»„ä»¶åº“æ–‡æ¡£ä¸­çš„å‚æ•°å’Œç»„ä»¶åéƒ½æ˜¯é’ˆå¯¹ React çš„ï¼ˆé™¤äº† React çš„ç‚¹å‡»äº‹ä»¶æ˜¯ `onClick` ä¹‹å¤–ï¼‰ã€‚
å¯¹äº Vue è€Œè¨€ï¼Œç»„ä»¶åå’Œç»„ä»¶å‚æ•°éƒ½é‡‡ç”¨çŸ­æ¨ªçº¿é£æ ¼ï¼ˆkebab-caseï¼‰çš„å‘½åæ–¹å¼ï¼Œä¾‹å¦‚ï¼š`<picker-view indicator-class="myclass" />`
:::

### è·¯ç”±ä¸ Tabbar

åœ¨ `src/components/thread` ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡

```js
Taro.navigateTo({ url: '/pages/thread_detail/thread_detail' })
```
è·³è½¬åˆ°å¸–å­è¯¦æƒ…ï¼Œä½†è¿™ä¸ªé¡µé¢ä»æœªå®ç°ï¼Œç°åœ¨æˆ‘ä»¬å»å…¥å£æ–‡ä»¶é…ç½®ä¸€ä¸ªæ–°çš„é¡µé¢ï¼š

```js title="src/app.config.js"

export default {
  pages: [
    'pages/index/index',
    'pages/thread_detail/thread_detail'
  ]
}
```

ç„¶ååœ¨è·¯å¾„ `src/pages/thread_detail/thread_detail` å®ç°å¸–å­è¯¦æƒ…é¡µé¢ï¼Œè·¯ç”±å°±å¯ä»¥è·³è½¬ï¼Œæˆ‘ä»¬æ•´ä¸ªæµç¨‹å°±è·‘èµ·æ¥äº†ï¼š

<Tabs
  defaultValue="React"
  values={[
    { label: <ReactIcon />, value: 'React', },
    { label: <VueIcon />, value: 'Vue', }
  ]
}>

<TabItem value="React">

```jsx title="src/pages/thread_detail/thread_detail"
import Taro from '@tarojs/taro'
import React from 'react'
import { View, RichText, Image } from '@tarojs/components'
import { Thread } from '../../components/thread'
import { Loading } from '../../components/loading'
import api from '../../utils/api'
import { timeagoInst, GlobalState } from '../../utils'

import './index.css'

function prettyHTML (str) {
  const lines = ['p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6']

  lines.forEach(line => {
    const regex = new RegExp(`<${line}`, 'gi')

    str = str.replace(regex, `<${line} class="line"`)
  })

  return str.replace(/<img/gi, '<img class="img"')
}

class ThreadDetail extends React.Component {
  state = {
    loading: true,
    replies: [],
    content: '',
    thread: {}
  } as IState

  config = {
    navigationBarTitleText: 'è¯é¢˜'
  }

  componentWillMount () {
    this.setState({
      thread: GlobalState.thread
    })
  }

  async componentDidMount () {
    try {
      const id = GlobalState.thread.tid
      const [{ data }, { data: [ { content_rendered } ] } ] = await Promise.all([
        Taro.request({
          url: api.getReplies({
            'topic_id': id
          })
        }),
        Taro.request({
          url: api.getTopics({
            id
          })
        })
      ])
      this.setState({
        loading: false,
        replies: data,
        content: prettyHTML(content_rendered)
      })
    } catch (error) {
      Taro.showToast({
        title: 'è½½å…¥è¿œç¨‹æ•°æ®é”™è¯¯'
      })
    }
  }

  render () {
    const { loading, replies, thread, content } = this.state

    const replieEl = replies.map((reply, index) => {
      const time = timeagoInst.format(reply.last_modified * 1000, 'zh')
      return (
        <View className='reply' key={reply.id}>
          <Image src={reply.member.avatar_large} className='avatar' />
          <View className='main'>
            <View className='author'>
              {reply.member.username}
            </View>
            <View className='time'>
              {time}
            </View>
            <RichText nodes={reply.content} className='content' />
            <View className='floor'>
              {index + 1} æ¥¼
            </View>
          </View>
        </View>
      )
    })

    const contentEl = loading
      ? <Loading />
      : (
        <View>
          <View className='main-content'>
          <RichText nodes={content} />
          </View>
          <View className='replies'>
            {replieEl}
          </View>
        </View>
      )

    return (
      <View className='detail'>
        <Thread
          node={thread.node}
          title={thread.title}
          last_modified={thread.last_modified}
          replies={thread.replies}
          tid={thread.id}
          member={thread.member}
          not_navi={true}
        />
        {contentEl}
      </View>
    )
  }
}

export default ThreadDetail
```

</TabItem>

<TabItem value="Vue">

```html title="src/pages/thread_detail/thread_detail.vue"

<template>
  <view class='detail'>
    <thread
      :node="topic.node"
      :title="topic.title"
      :last_modified="topic.last_modified"
      :replies="topic.replies"
      :tid="topic.id"
      :member="topic.member"
      :not_navi="true"
    />
    <loading v-if="loading" />
    <view v-else>
      <view class='main-content'>
        <rich-text :nodes="content | html" />
      </view>
      <view class='replies'>
        <view v-for="(reply, index) in replies" class='reply' :key="reply.id">
          <image :src='reply.member.avatar_large' class='avatar' />
          <view class='main'>
            <view class='author'>
              {{reply.member.username}}
            </view>
            <view class='time'>
              {{reply.last_modified | time}}
            </view>
            <rich-text :nodes="reply.content_rendered | html" class='content' />
            <view class='floor'>
              {{index + 1}} æ¥¼
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
</template>

<script>
import Vue from 'vue'
import Taro from '@tarojs/taro'
import api from '../../utils/api'
import { timeagoInst, GlobalState, IThreadProps, prettyHTML } from '../../utils'
import Thread from '../../components/thread.vue'
import Loading from '../../components/loading.vue'
import './index.css'
export default {
  components: {
    'loading': Loading,
    'thread': Thread
  },
  data () {
    return {
      topic: GlobalState.thread,
      loading: true,
      replies: [],
      content: ''
    }
  },
  async created () {
    try {
      const id = GlobalState.thread.tid
      const [{ data }, { data: [ { content_rendered } ] } ] = await Promise.all([
        Taro.request({
          url: api.getReplies({
            'topic_id': id
          })
        }),
        Taro.request({
          url: api.getTopics({
            id
          })
        })
      ])
      this.loading = false
      this.replies = data
      this.content = content_rendered
    } catch (error) {
      Taro.showToast({
        title: 'è½½å…¥è¿œç¨‹æ•°æ®é”™è¯¯'
      })
    }
  },
  filters: {
    time (val) {
      return timeagoInst.format(val * 1000)
    },
    html (val) {
      return prettyHTML(val)
    }
  }
}
</script>
```

</TabItem>

</Tabs>

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å®ç°äº†è¿™ä¸ªåº”ç”¨çš„æ‰€æœ‰é€»è¾‘ï¼Œé™¤å»ã€ŒèŠ‚ç‚¹åˆ—è¡¨ã€é¡µé¢ï¼ˆåœ¨è¿›é˜¶æŒ‡å—æˆ‘ä»¬ä¼šè®¨è®ºè¿™ä¸ªé¡µé¢ç»„ä»¶ï¼‰ä¹‹å¤–ï¼Œå‰©ä¸‹çš„é¡µé¢éƒ½å¯ä»¥é€šè¿‡æˆ‘ä»¬å·²ç»è®²è§£è¿‡çš„ç»„ä»¶æˆ–é¡µé¢å¿«é€ŸæŠ½è±¡å®Œæˆã€‚æŒ‰ç…§æˆ‘ä»¬çš„è®¡åˆ’ï¼Œè¿™ä¸ªåº”ç”¨ä¼šæœ‰äº”ä¸ªé¡µé¢ï¼Œåˆ†åˆ«æ˜¯ï¼š

1. é¦–é¡µï¼Œå±•ç¤ºæœ€æ–°å¸–å­ï¼ˆå·²å®Œæˆï¼‰
2. èŠ‚ç‚¹åˆ—è¡¨
3. çƒ­é—¨å¸–å­ï¼ˆå¯é€šè¿‡ç»„ä»¶å¤ç”¨ï¼‰
4. èŠ‚ç‚¹å¸–å­ ï¼ˆå¯é€šè¿‡ç»„ä»¶å¤ç”¨ï¼‰
5. å¸–å­è¯¦æƒ… ï¼ˆå·²å®Œæˆï¼‰

å…¶ä¸­å‰ä¸‰ä¸ªé¡µé¢æˆ‘ä»¬å¯ä»¥æŠŠå®ƒä»¬è§„åˆ’åœ¨ `tabBar` é‡Œï¼Œ`tabBar` æ˜¯ Taro å†…ç½®çš„å¯¼èˆªæ ï¼Œå¯ä»¥åœ¨ `app.config.js` é…ç½®ï¼Œé…ç½®å®Œæˆä¹‹åå¤„äºçš„ `tabBar` ä½ç½®çš„é¡µé¢ä¼šæ˜¾ç¤ºä¸€ä¸ªå¯¼èˆªæ ã€‚æœ€ç»ˆæˆ‘ä»¬çš„ `app.config.js` ä¼šæ˜¯è¿™æ ·ï¼š

```jsx title="app.config.js"
export default {
  pages: [
    'pages/index/index',
    'pages/nodes/nodes',
    'pages/hot/hot',
    'pages/node_detail/node_detail',
    'pages/thread_detail/thread_detail'
  ],
  tabBar: {
    list: [{
      'iconPath': 'resource/latest.png',
      'selectedIconPath': 'resource/lastest_on.png',
      pagePath: 'pages/index/index',
      text: 'æœ€æ–°'
    }, {
      'iconPath': 'resource/hotest.png',
      'selectedIconPath': 'resource/hotest_on.png',
      pagePath: 'pages/hot/hot',
      text: 'çƒ­é—¨'
    }, {
      'iconPath': 'resource/node.png',
      'selectedIconPath': 'resource/node_on.png',
      pagePath: 'pages/nodes/nodes',
      text: 'èŠ‚ç‚¹'
    }],
    'color': '#000',
    'selectedColor': '#56abe4',
    'backgroundColor': '#fff',
    'borderStyle': 'white'
  },
  window: {
    backgroundTextStyle: 'light',
    navigationBarBackgroundColor: '#fff',
    navigationBarTitleText: 'V2EX',
    navigationBarTextStyle: 'black'
  }
}
```

## é¡¹ç›®è¿›é˜¶ä¸ä¼˜åŒ–

### çŠ¶æ€ç®¡ç†

åœ¨æˆ‘ä»¬å®ç°å¸–å­ç»„ä»¶ï¼ˆ`src/components/thread`ï¼‰æ—¶ï¼Œé€šè¿‡ Taro å†…ç½®çš„ `eventCenter` å‘èµ·äº†ä¸€ä¸ªäº‹ä»¶ï¼ŒæŠŠå½“å‰å¸–å­çš„æ•°æ®æ³¨å…¥åˆ°ä¸€ä¸ªå…¨å±€çš„ `GlobalState` ä¸­ï¼Œç„¶ååœ¨å¸–å­è¯¦æƒ…é¡µé¢å†ä» `GlobalState` å–å‡ºå½“å‰å¸–å­çš„æ•°æ®â€”â€”è¿™ç§ç®€å•çš„å‘å¸ƒ/è®¢é˜…æ¨¡å¼åœ¨å¤„ç†ç®€å•é€»è¾‘æ—¶éå¸¸æœ‰æ•ˆä¸”æ¸…æ™°ã€‚

ä¸€æ—¦æˆ‘ä»¬çš„ä¸šåŠ¡é€»è¾‘å˜å¾—å¤æ‚ï¼Œä¸€ä¸ªç®€å•çš„å‘å¸ƒè®¢é˜…æœºåˆ¶ç»‘å®šåˆ°ä¸€ä¸ªå…¨å±€çš„ `state` å¯èƒ½å°±ä¼šå¯¼è‡´æˆ‘ä»¬çš„æ•°æ®æµå˜å¾—éš¾ä»¥è¿½è¸ªã€‚å¥½åœ¨è¿™ä¸ªé—®é¢˜ä¸ç®¡æ˜¯åœ¨ React è¿˜æ˜¯ Vue ç¤¾åŒºä¸­éƒ½æœ‰å¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆã€‚æˆ‘ä»¬ä¼šä½¿ç”¨è¿™ä¸¤ä¸ªç¤¾åŒºæœ€çƒ­é—¨çš„çŠ¶æ€ç®¡ç†å·¥å…·ï¼š`Redux` å’Œ `Vuex` æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

<Tabs
  defaultValue="redux"
  values={[
    {label: 'Redux', value: 'redux'},
    {label: 'Vuex', value: 'vuex'},
  ]}>
<TabItem value="redux">

é¦–å…ˆå®‰è£… `redux` å’Œ `react-redux`:

```bash
npm i redux react-redux
```

åœ¨å…¥å£æ–‡ä»¶ä½¿ç”¨ `react-redux` çš„ `Provider` æ³¨å…¥ `context` åˆ°æˆ‘ä»¬çš„åº”ç”¨ï¼š

```js title="src/app.js"
import React, { Component } from 'react'
import { Provider } from 'react-redux'
import { createStore, combineReducers } from 'redux';
import './app.css'

const reducers = combineReducers({
  thread: (state = {}, action) => {
    if (action.type === 'SET_CURRENT_THREAD') {
      return {
        ...state,
        ...action.thread
      }
    }
    return state
  }
})

const store = createStore(reducers)

class App extends Component {
  render () {
    // this.props.children æ˜¯å°†è¦ä¼šæ¸²æŸ“çš„é¡µé¢
    return (
      <Provider store={store}>
        {this.props.children}
      </Provider>
    )
  }
}

export default App
```

ç„¶ååœ¨å¸–å­ç»„ä»¶ä¸­æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ `connect` ä¸€ä¸ª `dispatch` è®¾ç½®å½“å‰çš„å¸–å­ï¼š

```diff title="src/components/thread.jsx"
- eventCenter.trigger(Thread_DETAIL_NAVIGATE, this.props)
+ this.props.setThread(this.props)
- export default Thread
+ const mapDispatchToProps = dispatch => {
+   return {
+     setThread: thread => dispatch({ type: 'SET_CURRENT_THREAD', thread })
+   }
+ }
+ export default connect(null, mapDispatchToProps)(Thread)
```

åœ¨å¸–å­è¯¦æƒ…ç»„ä»¶ä¸­é€šè¿‡ `connect` ä¸€ä¸ª `mapStateToProps` è·å–å½“å‰å¸–å­çš„æ•°æ®ï¼š

```diff title="src/components/thread_detail.jsx"
- const id = GlobalState.thread.tid
+ const id = this.props.thread.tid
- export default ThreadDetail
+ function mapStateToProps(state) {
+  return { thread: state.thread }
+ }
+ export default connect(mapStateToProps)(ThreadDetail)
```

:::caution è¯·æ³¨æ„
æ­¤æ•™ç¨‹æ¼”ç¤ºçš„æ˜¯ `Redux` æç®€ç”¨æ³•ï¼Œè€Œéæœ€ä½³å®è·µã€‚è¯¦æƒ…è¯·è®¿é—® [Redux æ–‡æ¡£](https://www.redux.org.cn/) å’Œ [react-redux æ–‡æ¡£](https://react-redux.js.org/introduction/quick-start)ã€‚
:::

</TabItem>
<TabItem value="vuex">


é¦–å…ˆå®‰è£… `vuex`:

```bash
npm i vuex
```

åœ¨å…¥å£æ–‡ä»¶ä¸­æ³¨å…¥ Vuex çš„ `store`ï¼š

```js title="src/app.js"
import Vue from 'vue'
import './app.css'

const store = new Vuex.Store({
  state: {
    thread: {}
  },
  mutations: {
  	setThread: (state, thread) => {
      state.thread = { ...thread }
    }
  }
})

const App = new Vue({
  store,
  render(h) {
    // this.$slots.default æ˜¯å°†è¦ä¼šæ¸²æŸ“çš„é¡µé¢
    return h('block', this.$slots.default)
  }
})

export default App
```

ç„¶ååœ¨å¸–å­ç»„ä»¶ä¸­æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ `this.$store.setThread()` è®¾ç½®å½“å‰çš„å¸–å­ï¼š

```diff title="src/components/thread.vue"
- eventCenter.trigger(Thread_DETAIL_NAVIGATE, this.props)
+ this.$store.setThread(this.$props)
```

åœ¨å¸–å­è¯¦æƒ…ç»„ä»¶ä¸­é€šè¿‡ `computed` è·å–å½“å‰å¸–å­çš„æ•°æ®ï¼š

```diff title="src/components/thread_detail.vue"
{
  data () {
    return {
-     topic: GlobalState.thread,
      loading: true,
      replies: [],
      content: ''
    }
  },
+ computed: {
+  topic() {
+    return this.$store.state.thread
+  }
+ }
}
```

:::caution è¯·æ³¨æ„
æ­¤æ•™ç¨‹æ¼”ç¤ºçš„æ˜¯ `Vuex` æç®€ç”¨æ³•ï¼Œè€Œéæœ€ä½³å®è·µã€‚è¯¦æƒ…è¯·è®¿é—® [Vuex æ–‡æ¡£](https://vuex.vuejs.org/zh/guide/)ã€‚
:::

</TabItem>
</Tabs>


#### å…¶å®ƒçŠ¶æ€ç®¡ç†å·¥å…·

åŸç†ä¸Šæ¥è¯´ï¼ŒTaro å¯ä»¥æ”¯æŒä»»ä½•å…¼å®¹ React æˆ– Vue çš„çŠ¶æ€ç®¡ç†å·¥å…·ï¼Œä½¿ç”¨è¿™ç±»å·¥å…·é€šå¸¸éƒ½ä¼šè¦æ±‚åœ¨å…¥å£ç»„ä»¶æ³¨å…¥ `context`ï¼Œè€Œåœ¨ Taro ä¸­å…¥å£æ–‡ä»¶æ˜¯ä¸èƒ½æ¸²æŸ“ UI çš„ã€‚åªè¦æ³¨æ„è¿™ç‚¹å³å¯ã€‚

åœ¨ Vue ç”Ÿæ€åœˆæˆ‘ä»¬æ¨èä½¿ç”¨ `Vuex`ã€‚React ç”Ÿæ€åœˆçŠ¶æ€ç®¡ç†å·¥å…·ç™¾èŠ±é½æ”¾ï¼Œè€ƒè™‘åˆ°ä½¿ç”¨ Taro çš„å¼€å‘è€…å¾ˆå¤šåº”ç”¨ä¼šç¼–è¯‘åˆ°å°ç¨‹åºï¼Œæˆ‘ä»¬æ¨èå‡ ä¸ªåœ¨æ€§èƒ½æˆ–ä½“ç§¯ä¸Šæœ‰ä¼˜åŠ¿çš„çŠ¶æ€ç®¡ç†å·¥å…·ï¼š

* [`mobx-react`](https://cn.mobx.js.org/): å’Œ Vuex ä¸€æ ·å“åº”å¼çš„çŠ¶æ€ç®¡ç†å·¥å…·
* [unstaged](https://github.com/jamiebuilds/unstated-next): åŸºäº React Hooks çš„æç®€çŠ¶æ€ç®¡ç†å·¥å…·ï¼Œå‹ç¼©ä½“ç§¯åªæœ‰ 200 å­—èŠ‚
* [Recoil](https://recoiljs.org/): Facebook æ¨å‡ºçš„åŸºäº React Hooks çš„çŠ¶æ€ç®¡ç†å·¥å…·

### CSS å·¥å…·

åœ¨ Taro ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªç”±åœ°ä½¿ç”¨ CSS é¢„å¤„ç†å™¨å’Œåå¤„ç†å™¨ï¼Œä½¿ç”¨çš„æ–¹æ³•ä¹Ÿéå¸¸ç®€å•ï¼Œåªè¦åœ¨ç¼–è¯‘é…ç½®æ·»åŠ ç›¸å…³çš„æ’ä»¶å³å¯ï¼š

```js {8,9,10} title="config/index.js"
const config = {
  projectName: 'v2ex',
  date: '2018-8-3',
  designWidth: 750,
  sourceRoot: 'src',
  outputRoot: 'dist',
  plugins: [
    '@tarojs/plugin-sass', // ä½¿ç”¨ Sass
    // '@tarojs/plugin-less', // ä½¿ç”¨ Less
    // '@tarojs/plugin-stylus', // ä½¿ç”¨ Stylus
  ],
  defineConstants: {
  },
  mini: {

  },
  h5: {
    publicPath: '/',
    staticDirectory: 'static',
    module: {
      postcss: {
        autoprefixer: {
          enable: true
        }
      }
    }
  }
}

module.exports = function (merge) {
  if (process.env.NODE_ENV === 'development') {
    return merge({}, config, require('./dev'))
  }
  return merge({}, config, require('./prod'))
}
```

:::info äº†è§£æ›´å¤š
é™¤äº† CSS é¢„å¤„ç†å™¨ä¹‹å¤–ï¼ŒTaro è¿˜æ”¯æŒ [CSS Modules]() å’Œ [CSS-in-JS](./css-in-js)ã€‚
åŸç†ä¸Šè¿˜æ”¯æŒæ›´å¤š CSS å·¥å…·ï¼Œæˆ‘ä»¬å°†åœ¨ [è‡ªå®šä¹‰ç¼–è¯‘](./guide/#è‡ªå®šä¹‰ç¼–è¯‘ä¸æ’ä»¶åŒ–ç³»ç»Ÿ) ç»§ç»­è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚
:::

### æ¸²æŸ“ HTML

åœ¨å¸–å­è¯¦æƒ…ç»„ä»¶ï¼ˆ`ThreadDetail`ï¼‰ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å†…ç½®ç»„ä»¶ `RichText` æ¥æ¸²æŸ“ HTMLï¼Œä½†è¿™ä¸ªç»„ä»¶çš„å…¼å®¹æ€§ä¸å¥½ï¼Œæ— æ³•åœ¨æ‰€æœ‰ç«¯éƒ½æ­£å¸¸ä½¿ç”¨ï¼ŒæŸäº›ç‰¹å®šçš„ HTML å…ƒç´ ä¹Ÿæ— æ³•æ¸²æŸ“ã€‚

å¹¸è¿çš„æ˜¯ï¼ŒTaro å†…ç½®äº† HTML æ¸²æŸ“ï¼Œä½¿ç”¨æ–¹æ³•ä¹Ÿå’Œ React/Vue åœ¨ Web å¼€å‘ä¸­æ²¡ä»€ä¹ˆåŒºåˆ«ï¼š

<Tabs
  defaultValue="React"
  values={[
    { label: <ReactIcon />, value: 'React', },
    { label: <VueIcon />, value: 'Vue', }
  ]
}>

<TabItem value="React">

```diff title="src/pages/thread_detail/thread_detail.jsx"
- <RichText nodes={reply.content} className='content' />
+ <View dangerouslySetInnerHTML={{ __html: reply.content }} className='content'></View>
```

</TabItem>

<TabItem value="Vue">

```diff title="src/pages/thread_detail/thread_detail.vue"
- <rich-text :nodes="reply.content_rendered | html" class='content' />
+ <view v-html="reply.content_rendered | html" class='content' />
```

</TabItem>

</Tabs>

:::info äº†è§£æ›´å¤š
Taro å†…ç½®çš„ HTML æ¸²æŸ“åŠŸèƒ½ä¸ä»…å¯ä»¥æŒ‰ Web å¼€å‘çš„æ–¹å¼å»ä½¿ç”¨ï¼Œä¹Ÿæ”¯æŒè‡ªå®šä¹‰æ ·å¼ã€è‡ªå®šä¹‰æ¸²æŸ“ã€è‡ªå®šä¹‰äº‹ä»¶è¿™æ ·çš„é«˜çº§åŠŸèƒ½ã€‚
ä½ å¯ä»¥è®¿é—® [HTML æ¸²æŸ“æ–‡æ¡£](./html) äº†è§£æ›´å¤šã€‚
:::

### æ€§èƒ½ä¼˜åŒ–

#### è™šæ‹Ÿåˆ—è¡¨

åœ¨å¸–å­åˆ—è¡¨ç»„ä»¶ï¼ˆ`ThreadList`ï¼‰ä¸­ï¼Œæˆ‘ä»¬ç›´æ¥æ¸²æŸ“ä»è¿œç¨‹å¾—æ¥çš„æ•°æ®ã€‚è¿™æ ·åšæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†å¦‚æœæˆ‘ä»¬çš„æ•°æ®éå¸¸åºå¤§ï¼Œæˆ–è€…åˆ—è¡¨æ¸²æŸ“çš„ DOM ç»“æ„å¼‚å¸¸å¤æ‚ï¼Œè¿™å°±å¯èƒ½ä¼šäº§ç”Ÿæ€§èƒ½é—®é¢˜ã€‚

ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼ŒTaro å†…ç½®äº†è™šæ‹Ÿåˆ—è¡¨ï¼ˆ`VirtualList`ï¼‰åŠŸèƒ½ï¼Œæ¯”èµ·å…¨é‡æ¸²æŸ“æ‰€æœ‰åˆ—è¡¨æ•°æ®ï¼Œæˆ‘ä»¬åªéœ€è¦æ¸²æŸ“å½“å‰å¯è§†åŒºåŸŸ(visable viewport)çš„è§†å›¾ï¼š

<Tabs
  defaultValue="React"
  values={[
    { label: <ReactIcon />, value: 'React', },
    { label: <VueIcon />, value: 'Vue', }
  ]
}>

<TabItem value="React">

```jsx title="src/pages/thread_detail/thread_list.jsx"
import React from 'react'
import { View, Text } from '@tarojs/components'
import { Thread } from './thread'
import { Loading } from './loading'
import VirtualList from `@tarojs/components/virtual-list`


import './thread.css'

const Row = React.memo(({ thread }) => {
  return (
    <Thread
      key={thread.id}
      node={thread.node}
      title={thread.title}
      last_modified={thread.last_modified}
      replies={thread.replies}
      tid={thread.id}
      member={thread.member}
    />
  )
})

class ThreadList extends React.Component {
  static defaultProps = {
    threads: [],
    loading: true
  }

  render () {
    const { loading, threads } = this.props

    if (loading) {
      return <Loading />
    }

    const element = (
      <VirtualList
        height={800} /* åˆ—è¡¨çš„é«˜åº¦ */
        width='100%' /* åˆ—è¡¨çš„å®½åº¦ */
        itemData={threads} /* æ¸²æŸ“åˆ—è¡¨çš„æ•°æ® */
        itemCount={threads.length} /*  æ¸²æŸ“åˆ—è¡¨çš„é•¿åº¦ */
        itemSize={100} /* åˆ—è¡¨å•é¡¹çš„é«˜åº¦  */
      >
        {Row} /* åˆ—è¡¨å•é¡¹ç»„ä»¶ï¼Œè¿™é‡Œåªèƒ½ä¼ å…¥ä¸€ä¸ªç»„ä»¶ */
      </VirtualList>
    )

    return (
      <View className='thread-list'>
        {element}
      </View>
    )
  }
}

export { ThreadList }
```

</TabItem>

<TabItem value="Vue">

```js title="app.js"
// åœ¨å…¥å£æ–‡ä»¶æ–°å¢ä½¿ç”¨æ’ä»¶
import VirtualList from `@tarojs/components/virtual-list`
Vue.use(VirtualList)
```

```html title="src/components/row.vue"
<template>
  <thread
    :key="data.id"
    :node="data.node"
    :title="data.title"
    :last_modified="data.last_modified"
    :replies="data.replies"
    :tid="data.id"
    :member="data.member"
  />
</template>

<script>
import Thread from './thread.vue'
export default {
  components: {
    'thread': Thread
  },
  props: ['index', 'data', 'css']
}
</script>
```

```html title="src/components/thread_list.vue"
<template>
  <view className='thread-list'>
    <loading v-if="loading" />
    <virtual-list
      v-else
      :height="500"
      :item-data="threads"
      :item-count="threads.length"
      :item-size="100"
      :item="Row"
      width="100%"
    />
  </view>
</template>

<script >
import Vue from 'vue'
import Loading from './loading.vue'
import Thread from './thread.vue'
import Row from './row.vue'
export default {
  components: {
    'loading': Loading,
    'thread': Thread
  },
  props: {
    threads: {
      type: Array,
      default: []
    },
    loading: {
      type: Boolean,
      default: true
    }
  }
}
</script>
```

</TabItem>

</Tabs>

:::info äº†è§£æ›´å¤š
åœ¨æ–‡æ¡£[è™šæ‹Ÿåˆ—è¡¨](./virtual-list) ä½ å¯ä»¥æ‰¾åˆ°è™šæ‹Ÿåˆ—è¡¨çš„ä¸€äº›é«˜çº§ç”¨æ³•ï¼Œä¾‹å¦‚ï¼šæ— é™æ»šåŠ¨ã€æ»šåŠ¨åç§»ã€æ»šåŠ¨äº‹ä»¶ç­‰ã€‚
:::

#### é¢„æ¸²æŸ“

ç°åœ¨æˆ‘ä»¬æ¥å®ç°æœ€åä¸€ä¸ªé¡µé¢ï¼šèŠ‚ç‚¹åˆ—è¡¨é¡µé¢ã€‚è¿™ä¸ªé¡µé¢æœ¬è´¨è¯´å°±æ˜¯æ¸²æŸ“ä¸€ä¸ªå­˜åœ¨æœ¬åœ°çš„å·¨å¤§åˆ—è¡¨ï¼š

<Tabs
  defaultValue="React"
  values={[
    { label: <ReactIcon />, value: 'React', },
    { label: <VueIcon />, value: 'Vue', }
  ]
}>

<TabItem value="React">

```jsx title="src/pages/nodes/nodes.jsx"
import React from 'react'
import { View, Text, Navigator } from '@tarojs/components'
import allNodes from './all_node'
import api from '../../utils/api'

import './nodes.css'

function Nodes () {
  const element = allNodes.map(item => {
    return (
      <View key={item.title} className='container'>
        <View className='title'>
          <Text style='margin-left: 5px'>{item.title}</Text>
        </View>
        <View className='nodes'>
          {item.nodes.map(node => {
            return (
              <Navigator
                className='tag'
                url={`/pages/node_detail/node_detail${api.queryString(node)}`}
                key={node.full_name}
              >
                <Text>{node.full_name}</Text>
              </Navigator>
            )
          })}
        </View>
      </View>
    )
  })
  return <View className='node-container'>{element}</View>
}

export default Nodes
```

</TabItem>

<TabItem value="Vue">

```html title="src/pages/nodes/nodes.vue"
<template>
  <view class='node-container'>
    <view v-for="item in allNodes" :key="item.title" class='container'>
      <view class='title'>
        <text style='margin-left: 5px'>{{item.title}}</text>
      </view>
      <view class='nodes'>
        <navigator
          v-for="node in item.nodes"
          :key="node.full_name"
          class='tag'
          :url="node | url"
        >
          <text>{{node.full_name}}</text>
        </navigator>
      </view>
    </view>
  </view>
</template>

<script>
import Vue from 'vue'
import allNodes from './all_node'
import api from '../../utils/api'
import './nodes.css'

function getURL (node) {
  return `/pages/node_detail/node_detail${api.queryString(node)}`
}

export default {
  data () {
    return {
      allNodes
    }
  },
  filters: {
    url (node) {
      return getURL(node)
    }
  }
}
</script>
```

</TabItem>

</Tabs>

è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ•´ä¸ªåº”ç”¨å°±å®Œæˆäº†ã€‚ä½†å¦‚æœä½ æŠŠè¿™ä¸ªåº”ç”¨æ”¾åœ¨çœŸæœºå°ç¨‹åºä¸­ï¼Œå°¤å…¶æ˜¯ä¸€äº›æ€§èƒ½ä¸é«˜çš„çœŸæœºä¸­ï¼Œåˆ‡æ¢åˆ°æ­¤é¡µé¢çš„æ—¶é—´å¯èƒ½ä¼šæ¯”è¾ƒé•¿ï¼Œä¼šæœ‰ä¸€æ®µç™½å±æ—¶é—´ã€‚

è¿™æ˜¯ç”±äº Taro çš„æ¸²æŸ“æœºåˆ¶å¯¼è‡´çš„ï¼šåœ¨é¡µé¢åˆå§‹åŒ–æ—¶ï¼ŒåŸç”Ÿå°ç¨‹åºå¯ä»¥ä»æœ¬åœ°ç›´æ¥å–æ•°æ®æ¸²æŸ“ï¼Œä½† Taro ä¼šæŠŠåˆå§‹æ•°æ®é€šè¿‡ React/Vue æ¸²æŸ“æˆä¸€é¢— DOM æ ‘ï¼Œç„¶åå°†è¿™é¢— DOM æ ‘åºåˆ—åŒ–ä¹‹åäº¤ç»™å°ç¨‹åºæ¸²æŸ“ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯”èµ·åŸç”Ÿå°ç¨‹åº Taro ä¼šåœ¨é¡µé¢åˆå§‹åŒ–æ—¶å¤šä¸€æ¬¡è°ƒç”¨ `setData` å‡½æ•°çš„æ”¯å‡ºâ€”â€”è€Œå¤§éƒ¨åˆ†å°ç¨‹åºçš„æ€§èƒ½é—®é¢˜æ˜¯ `setData` æ•°æ®è¿‡å¤§å¯¼è‡´çš„ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒTaro å¼•å…¥äº†ä¸€ç§åä¸ºé¢„æ¸²æŸ“ï¼ˆPrerenderï¼‰çš„æŠ€æœ¯ï¼Œå’ŒæœåŠ¡ç«¯æ¸²æŸ“ä¸€æ ·ï¼Œåœ¨ Taro CLI ç›´æ¥å°†è¦æ¸²æŸ“çš„é¡µé¢è½¬æ¢ä¸º `wxml` å­—ç¬¦ä¸²ï¼Œè¿™æ ·å°±è·å¾—äº†ä¸åŸç”Ÿå°ç¨‹åºä¸€è‡´ç”šè‡³æ›´å¿«çš„é€Ÿåº¦ã€‚

ä½¿ç”¨é¢„æ¸²æŸ“ä¹Ÿéå¸¸ç®€å•ï¼Œæˆ‘ä»¬åªè¦è¿›è¡Œç®€å•çš„é…ç½®å³å¯ï¼š

```js {4-6} title="config/prod.js"
const config = {
  ...
  mini: {
    prerender: {
      include: ['pages/nodes/nodes'], // `pages/nodes/nodes` ä¹Ÿä¼šå‚ä¸ prerender
    }
  }
};

// æˆ‘ä»¬è¿™é‡Œåœ¨ç¼–è¯‘ç”Ÿäº§æ¨¡å¼æ—¶æ‰å¼€å¯é¢„æ¸²æŸ“
// å¦‚æœéœ€è¦å¼€å‘æ—¶ä¹Ÿå¼€å¯ï¼Œé‚£å°±æŠŠé…ç½®æ”¾åœ¨ `config/index` æˆ– `config/dev`
module.exports = config
```

:::info äº†è§£æ›´å¤š
é¢„æ¸²æŸ“çš„é…ç½®æ”¯æŒæ¡ä»¶æ¸²æŸ“é¡µé¢ã€æ¡ä»¶æ¸²æŸ“é€»è¾‘ã€è‡ªå®šä¹‰æ¸²æŸ“å‡½æ•°ç­‰åŠŸèƒ½ï¼Œè¯¦æƒ…å¯ä»¥è®¿é—®[é¢„æ¸²æŸ“æ–‡æ¡£](./prerender)ã€‚
:::

### æ‰“åŒ…ä½“ç§¯

é»˜è®¤è€Œè¨€ä½¿ç”¨ç”Ÿäº§æ¨¡å¼æ‰“åŒ…ï¼ŒTaro å°±ä¼šç»™ä½ ä¼˜åŒ–æ‰“åŒ…ä½“ç§¯ã€‚ä½†å€¼å¾—æ³¨æ„ï¼ŒTaro é»˜è®¤çš„æ‰“åŒ…é…ç½®æ˜¯ä¸ºäº†è®©å¤šæ•°é¡¹ç›®å’Œéœ€æ±‚éƒ½å¯ä»¥è¿è¡Œï¼Œè€Œä¸æ˜¯é’ˆå¯¹ä»»ä½•é¡¹ç›®çš„æœ€ä¼˜é€‰æ‹©ã€‚å› æ­¤ä½ å¯ä»¥åœ¨ Taro é…ç½®çš„åŸºç¡€ä¹‹ä¸Šå†é’ˆå¯¹è‡ªå·±çš„é¡¹ç›®è¿›è¡Œä¼˜åŒ–ã€‚

#### JavaScript

åœ¨ Taro åº”ç”¨ä¸­ï¼Œæ‰€æœ‰ Java(Type)Script éƒ½æ˜¯é€šè¿‡ `babel.config.js` é…ç½®çš„ï¼Œå…·ä½“æ¥è¯´æ˜¯ä½¿ç”¨ [`babel-prest-taro`](https://www.npmjs.com/package/babel-preset-taro) è¿™ä¸ª Babel æ’ä»¶ç¼–è¯‘çš„ã€‚

é»˜è®¤è€Œè¨€ Taro ä¼šå…¼å®¹æ‰€æœ‰ [`@babel/preset-env`](https://www.npmjs.com/package/@babel/preset-env) æ”¯æŒçš„è¯­æ³•ï¼Œå¹¶å…¼å®¹åˆ° `iOS 9` å’Œ `Android 5`ï¼Œå¦‚æœä½ ä¸éœ€è¦é‚£ä¹ˆé«˜çš„å…¼å®¹æ€§ï¼Œæˆ–è€…ä¸éœ€è¦æŸäº› ES2015+ è¯­æ³•æ”¯æŒï¼Œå¯ä»¥è‡ªè¡Œé…ç½® `babel.config.js` è¾¾åˆ°ç¼©å°æ‰“åŒ…ä½“ç§¯æ•ˆæœã€‚

ä¾‹å¦‚æˆ‘ä»¬å¯ä»¥æŠŠå…¼å®¹æ€§æå‡åˆ° `iOS 12`ï¼š

```js title="babel.config.js"
// babel.config.js
module.exports = {
  presets: [
    ['taro', {
      targets: {
        ios: '12'
      }
    }]
  ]
}
```

ä½ å¯ä»¥è®¿é—® [Babel æ–‡æ¡£](https://babeljs.io/) äº†è§£æ›´å¤šè‡ªå®šä¹‰é…ç½®çš„ä¿¡æ¯ã€‚

#### æ‰“åŒ…ä½“ç§¯åˆ†æ

Taro ä½¿ç”¨ [Webpack](https://www.webpackjs.com/) ä½œä¸ºå†…éƒ¨çš„æ‰“åŒ…ç³»ç»Ÿï¼Œæœ‰æ—¶å€™å½“æˆ‘ä»¬çš„ä¸šåŠ¡ä»£ç ä½¿ç”¨äº† `require` è¯­æ³•æˆ–è€… `import default` è¯­æ³•ï¼ŒWebpack å¹¶ä¸èƒ½ç»™æˆ‘ä»¬æä¾› `tree-shaking` çš„æ•ˆæœã€‚åœ¨è¿™æ ·çš„æƒ…å†µä¸‹æˆ‘ä»¬é€šè¿‡ [`webpack-bundle-analyzer`](https://www.npmjs.com/package/webpack-bundle-analyzer) æ¥åˆ†ææˆ‘ä»¬ä¾èµ–æ‰“åŒ…ä½“ç§¯ï¼Œè¿™ä¸ªæ’ä»¶ä¼šåœ¨æµè§ˆå™¨æ‰“å¼€ä¸€ä¸ªå¯è§†åŒ–çš„å›¾è¡¨é¡µé¢å‘Šè¯‰æˆ‘ä»¬å¼•ç”¨å„ä¸ªåŒ…çš„ä½“ç§¯ã€‚

é¦–å…ˆå®‰è£… `webpack-bundle-analyzer` ä¾èµ–:

```bash
npm install webpack-bundle-analyzer -D
```

ç„¶ååœ¨ [mini.webpackChain](./config-detail/#miniwebpackchain-1) ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š

```js {4-7} title="config/index"
const config = {
  ...
  mini: {
    webpackChain (chain, webpack) {
      chain.plugin('analyzer')
        .use(require('webpack-bundle-analyzer').BundleAnalyzerPlugin, [])
    }
  }
}
```

è¿è¡Œç¼–è¯‘å‘½ä»¤å®Œæˆä¹‹åå°±å¯ä»¥çœ‹åˆ°å„æ–‡ä»¶ä¾èµ–å…³ç³»åŠä½“ç§¯ã€‚

ä½ å¯ä»¥è®¿é—® [webpack-bundle-analyzer](https://www.npmjs.com/package/webpack-bundle-analyzer) æ–‡æ¡£äº†è§£è¯¦ç»†çš„ç”¨æ³•ã€‚

#### åˆ†åŒ…

åœ¨ä¸€äº›æƒ…å†µï¼Œæˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„é¡µé¢åªæœ‰å½“ç”¨åˆ°æ—¶æ‰æŒ‰éœ€è¿›è¡ŒåŠ è½½ã€‚è¿™ç§æƒ…å†µåœ¨ Taro åº”ç”¨è¢«ç§°ä¸ºåˆ†åŒ…ï¼Œåˆ†åŒ…çš„ä½¿ç”¨ä¹Ÿéå¸¸ç®€å•ï¼Œåªéœ€è¦é€šè¿‡é…ç½®å…¥å£æ–‡ä»¶ `app.config.js` å³å¯ã€‚

å‡è®¾æˆ‘ä»¬éœ€è¦æŠŠåˆšåˆšå®ç°é¢„æ¸²æŸ“çš„æ‰€æœ‰èŠ‚ç‚¹é¡µé¢è¿›è¡Œåˆ†åŒ…ï¼š

```js title="src/app.config.js"
export default {
  pages: [
    'pages/index/index',
    // 'pages/nodes/nodes', æŠŠè¦åˆ†åŒ…çš„é¡µé¢ä» `pages` å­—æ®µä¸­åˆ é™¤
    'pages/hot/hot',
    'pages/node_detail/node_detail',
    'pages/thread_detail/thread_detail'
  ],
  // åœ¨ `subpackages` å­—æ®µæ·»åŠ åˆ†åŒ…
  "subpackages": [
    {
      "root": "pages",
      "pages": [
        "nodes/nodes"
      ]
    }
  ]
  tabBar: {
    list: [{
      'iconPath': 'resource/latest.png',
      'selectedIconPath': 'resource/lastest_on.png',
      pagePath: 'pages/index/index',
      text: 'æœ€æ–°'
    }, {
      'iconPath': 'resource/hotest.png',
      'selectedIconPath': 'resource/hotest_on.png',
      pagePath: 'pages/hot/hot',
      text: 'çƒ­é—¨'
    }, {
      'iconPath': 'resource/node.png',
      'selectedIconPath': 'resource/node_on.png',
      pagePath: 'pages/nodes/nodes',
      text: 'èŠ‚ç‚¹'
    }],
    'color': '#000',
    'selectedColor': '#56abe4',
    'backgroundColor': '#fff',
    'borderStyle': 'white'
  },
  window: {
    backgroundTextStyle: 'light',
    navigationBarBackgroundColor: '#fff',
    navigationBarTitleText: 'V2EX',
    navigationBarTextStyle: 'black'
  }
}
```

### è‡ªå®šä¹‰ç¼–è¯‘

åœ¨ç‰¹å®šçš„æƒ…å†µä¸‹ï¼ŒTaro è‡ªå¸¦çš„ç¼–è¯‘ç³»ç»Ÿæ²¡æœ‰åŠæ³•æ»¡è¶³æˆ‘ä»¬çš„ç¼–è¯‘éœ€æ±‚ï¼Œè¿™æ—¶ Taro æä¾›äº†ä¸¤ç§æ‹“å±•ç¼–è¯‘çš„æ–¹æ¡ˆï¼š

#### ä½¿ç”¨ Webpack è¿›è¡Œæ‹“å±•

åœ¨[æ‰“åŒ…ä½“ç§¯åˆ†æ](./guide#æ‰“åŒ…ä½“ç§¯åˆ†æ) ä¸­æˆ‘ä»¬åœ¨ [mini.webpackChain](./config-detail/#miniwebpackchain-1) æ·»åŠ äº†ä¸€ä¸ª Webpack æ’ä»¶ï¼Œè¾¾åˆ°äº†æ‰“åŒ…ä½“ç§¯/ä¾èµ–åˆ†æçš„æ•ˆæœã€‚

äº‹å®ä¸Šé€šè¿‡ `mini.webpackChain` è¿™ä¸ªé…ç½®æˆ‘ä»¬å¯ä»¥å‡ ä¹ä½¿ç”¨ä»»ä½• Webpack ç”Ÿæ€çš„æ’ä»¶å’Œ `loader`ï¼Œä¾‹å¦‚æˆ‘ä»¬æƒ³ä½¿ç”¨ `CoffeeScript` æ¥è¿›è¡Œå¼€å‘ï¼š

```js {4-7} title="config/index"
const config = {
  ...
  mini: {
    webpackChain (chain, webpack) {
      chain.merge({
          module: {
              rule: {
                  test: /\.coffee$/,
                  use: [ 'coffee-loader' ]
              }
          }
      })
    }
  }
}
```

åŒæ ·ï¼Œä¹‹å‰æˆ‘ä»¬æåˆ°è¿‡çš„ `CSS Modules` ä¹Ÿå¯ä»¥é€šè¿‡ Webpack çš„å½¢å¼è¿›è¡Œæ‹“å±•æ”¯æŒã€‚è¯¦æƒ…å¯ä»¥è®¿é—® [webpack-chain](https://github.com/neutrinojs/webpack-chain) æ–‡æ¡£äº†è§£è¯¦ç»†çš„ç”¨æ³•ã€‚

#### ä½¿ç”¨æ’ä»¶åŒ–ç³»ç»Ÿè¿›è¡Œæ‹“å±•

åœ¨ [CSS å·¥å…·](./guide#CSS-å·¥å…·) æˆ‘ä»¬å·²ç»ä½¿ç”¨äº†åä¸º `@tarojs/plugin-sass` çš„æ’ä»¶æ¥å®ç°å¯¹ `Sass` çš„æ”¯æŒã€‚æ¯”èµ·ä½¿ç”¨ Webpack æ‹“å±•ç¼–è¯‘ï¼ŒTaro çš„æ’ä»¶åŠŸèƒ½ä¸ç”¨åœ¨æ¯ä¸ªç«¯éƒ½å¯¹ Webpack è¿›è¡Œé…ç½®ï¼Œåªç”¨ä½¿ç”¨æ’ä»¶å³å¯ã€‚

é™¤æ­¤ä¹‹å¤–ï¼ŒTaro çš„æ’ä»¶åŒ–åŠŸèƒ½è¿˜å¯ä»¥æ‹“å±• Taro CLI ç¼–è¯‘å‘½ä»¤ï¼Œæ‹“å±•ç¼–è¯‘æµç¨‹ï¼Œæ‹“å±•ç¼–è¯‘å¹³å°ï¼Œä½ å¯ä»¥è®¿é—® [æ’ä»¶åŠŸèƒ½æ–‡æ¡£](./plugin) äº†è§£æ›´å¤šè‡ªå®šä¹‰é…ç½®çš„ä¿¡æ¯ã€‚

:::info äº†è§£æ›´å¤š
é™¤äº†ä»¥ä¸Šä¸¤ç§æ–¹å¼å¤–ï¼ŒTaro è¿˜æä¾›å¤§é‡çš„ç¼–è¯‘ç›¸å…³é€‰é¡¹ï¼Œä½ å¯ä»¥è®¿é—® [ç¼–è¯‘é…ç½®è¯¦æƒ…](./config-detail) æ–‡æ¡£äº†è§£æ›´å¤šã€‚
:::

## å¤šç«¯å¼€å‘

### è·¨å¹³å°å¼€å‘

åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸åŒå¹³å°çš„è¡¨ç°æˆ–ä¸šåŠ¡é€»è¾‘æœ‰è´¨çš„ä¸åŒã€‚åœ¨è¿™æ ·çš„æƒ…å†µä¸‹æˆ‘ä»¬æ˜¯æ²¡æœ‰åŠæ³•åšåˆ°ã€Œä¸€å¥—ä»£ç èµ°å¤©ä¸‹ã€çš„ã€‚

ä¾‹å¦‚æˆ‘ä»¬æ­£åœ¨å®ç° V2EX è®ºå›åº”ç”¨ï¼Œå½“å‰çš„ API æ²¡æœ‰åŠæ³•åœ¨æµè§ˆå™¨ä¸­è·¨åŸŸè°ƒç”¨ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨ H5 ç«¯ä½¿ç”¨å¦ä¸€ä»½ APIã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å†…ç½®ç¯å¢ƒå˜é‡æ¥è§£å†³ï¼š

```diff
- import api from '../../utils/api'
// æˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸åŒçš„å¹³å°ï¼Œå¼•å…¥ä¸åŒçš„ API
+ let api
+ if (process.env.TARO_ENV === 'weapp') {
+  api = require('../../utils/api-weapp')
+ } else if (process.env.TARO_ENV === 'h5') {
+  api = require('../../utils/api-h5')
+ }
```

Taro è¿˜æä¾›äº†[ç»Ÿä¸€æ¥å£çš„å¤šç«¯æ–‡ä»¶](./envs#ç»Ÿä¸€æ¥å£çš„å¤šç«¯æ–‡ä»¶)ï¼Œé€šè¿‡ä¸åŒçš„å‘½åæ–¹å¼å¯»æ‰¾ä¾èµ–ï¼Œåœ¨è¿™ç±»æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä¿ç•™ï¼š

```js
import api from '../../utils/api'
```

è¯­å¥åŸå°ä¸åŠ¨ï¼Œä¿®æ”¹æˆ‘ä»¬çš„æ–‡ä»¶ç»“æ„ï¼Œåœ¨æ–‡ä»¶åå’Œåç¼€åä¹‹é—´åŠ ä¸Šå¹³å°çš„åå­—ï¼š

```bash
.
â””â”€â”€ utils
    â”œâ”€â”€ api.h5.js
    â”œâ”€â”€ api.weapp.js
    â””â”€â”€ index.js
```

:::info äº†è§£æ›´å¤š
é™¤äº†ã€Œå†…ç½®ç¯å¢ƒå˜é‡ã€å’Œã€Œç»Ÿä¸€æ¥å£çš„å¤šç«¯æ–‡ä»¶ã€ä¹‹å¤–ï¼ŒTaro è¿˜æä¾›äº†åˆ«çš„è·¨å¹³å°å¼€å‘è§£å†³æ–¹æ¡ˆï¼Œä½ å¯ä»¥è®¿é—®æ–‡æ¡£ [è·¨å¹³å°å¼€å‘](./envs) äº†è§£æ›´å¤šã€‚
:::

### åŒæ­¥è°ƒè¯•

é»˜è®¤æƒ…å†µä¸‹ï¼ŒTaro ä¼šæŠŠå„ç«¯æ‰“åŒ…åçš„æ–‡ä»¶éƒ½æ”¾åœ¨ `dist` ç›®å½•ã€‚å¦‚æœä½ æƒ³è¦å¤šç«¯åŒæ­¥è°ƒè¯•çš„è¯å…ˆç¼–è¯‘åçš„æ–‡ä»¶å°±ä¼šè¢«åç¼–è¯‘å¥½çš„æ–‡ä»¶è¦†ç›–ã€‚

ä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹ç¼–è¯‘é…ç½®çš„ `outputRoot` è¾¾åˆ°å¤šç«¯åŒæ­¥è°ƒè¯•çš„ç›®çš„ï¼š

```js {2} title="config/index.js"
const config = {
  outputRoot: `dist/${process.env.TARO_ENV}`
}
```

åœ¨è¿™æ ·çš„é…ç½®ä¸‹ï¼Œå¾®ä¿¡å°ç¨‹åºç¼–è¯‘åçš„ç›®å½•å°±ä¼šæ˜¯ `dist/weapp`ï¼ŒH5 ç¼–è¯‘åç›®å½•å°±ä¼šæ˜¯ `dist/h5`ã€‚

### ä½¿ç”¨åŸç”Ÿå°ç¨‹åºç»„ä»¶

æŸäº›æƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦å¤ç”¨å°ç¨‹åºæ—¢æœ‰ç”Ÿæ€ï¼Œè€Œå°ç¨‹åºçš„ç»„ä»¶/åº“é€šå¸¸æ˜¯é’ˆå¯¹ç‰¹å®šå°ç¨‹åºå†™çš„ï¼Œå¹¶ä¸èƒ½ç›´æ¥åœ¨ Taro ä¸Šä½¿ç”¨ï¼Œéœ€è¦ä¸€äº›é¢å¤–çš„æ“ä½œã€‚

ä¾‹å¦‚æˆ‘ä»¬çš„è®ºå›åº”ç”¨ï¼Œåœ¨å¸–å­è¯¦æƒ…å¯èƒ½æœåŠ¡ç«¯è¿”å›çš„æ˜¯ MarkDown æ ¼å¼ï¼Œæˆ‘ä»¬å°±éœ€è¦ `towxml` æ¥æ¸²æŸ“çš„æˆ‘ä»¬çš„å¸–å­ï¼š

é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨å¸–å­è¯¦æƒ…é¡µé¢çš„é…ç½®æ–‡ä»¶ä¸­å¼•ç”¨ `towxml`:

```js
export default {
  "usingComponents": {
    "towxml":"../../towxml/towxml"
  }
}
```

ç„¶åä½¿ç”¨ `towxml` ç»„ä»¶ï¼Œè¿™é‡Œå¿…é¡»è®°ä½çš„æ˜¯ä¸ç®¡æ˜¯ React è¿˜æ˜¯ Vueï¼ŒåŸç”Ÿå°ç¨‹åºç»„ä»¶å£°æ˜éœ€è¦æ˜¯å°å†™çš„

<Tabs
  defaultValue="React"
  values={[
    { label: <ReactIcon />, value: 'React', },
    { label: <VueIcon />, value: 'Vue', }
  ]
}>

<TabItem value="React">

```diff title="src/pages/thread_detail/thread_detail.jsx"
- <View dangerouslySetInnerHTML={{ __html: reply.content }} className='content'></View>
+ <towxml nodes="{{reply.content}}" />
```

</TabItem>

<TabItem value="Vue">

```diff title="src/pages/thread_detail/thread_detail.vue"
- <view v-html="reply.content_rendered | html" class='content' />
+ <towxml :nodes="reply.content_rendered | html" />
```

</TabItem>

</Tabs>

æœ€åæŒ‰ç…§ [towxml](./https://github.com/sbfkcel/towxml/wiki/3.0-%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8) æ–‡æ¡£è°ƒç”¨å³å¯ã€‚


:::caution è¯·æ³¨æ„
ä¸€æ—¦ä½¿ç”¨äº†åŸç”Ÿå°ç¨‹åºç»„ä»¶ï¼ŒTaro åº”ç”¨å°±å¤±å»äº†è·¨ç«¯çš„èƒ½åŠ›ã€‚
:::

:::info äº†è§£æ›´å¤š
Taro è¿˜æ”¯æŒä½¿ç”¨å°ç¨‹åºæ’ä»¶ï¼Œè¯¦æƒ…å¯ä»¥è®¿é—®æ–‡æ¡£[ä½¿ç”¨å°ç¨‹åºåŸç”Ÿç¬¬ä¸‰æ–¹ç»„ä»¶å’Œæ’ä»¶](./mini-third-party)ã€‚
:::
